<?php

if (!defined('CIVICRM_UF_DSN') && CIVICRM_UF !== 'UnitTests') {
  define('CIVICRM_UF_DSN', 'mysql://{{getv "/ds-composites/db/username"}}:{{getv "/ds-composites/db/password"}}@{{getv "/ds-composites/db/host"}}:{{getv "/ds-composites/db/port"}}/{{getv "/ds-composites/db/database"}}?new_link=true');
}

// Additional settings generated by installer:
$civicrm_paths['civicrm.files']['url'] = '{{getv "/ds-composites/baseurl"}}/sites/default/files/civicrm';
$civicrm_paths['civicrm.files']['path'] = '{{getv "/ds-composites/public-files"}}/civicrm';
$civicrm_paths['civicrm.private']['path'] = '{{getv "/ds-composites/private-files"}}/civicrm';

if (!defined('CIVICRM_DSN')) {
  if (CIVICRM_UF === 'UnitTests') {
    if (isset($GLOBALS['_CV']['TEST_DB_DSN'])) {
      define('CIVICRM_DSN', $GLOBALS['_CV']['TEST_DB_DSN']);
    }
    else {
      throw new \Exception('$GLOBALS["_CV"]["TEST_DB_DSN"] is not set');
    }
  }
  else {
    define('CIVICRM_DSN', 'mysql://{{getv "/ds-composites/civi/username"}}:{{getv "/ds-composites/civi/password"}}@{{getv "/ds-composites/civi/host"}}:{{getv "/ds-composites/civi/port"}}/{{getv "/ds-composites/civi/database"}}?new_link=true');
  }
}

$civicrm_root = '{{getv "/ds-composites/basepath"}}/vendor/civicrm/civicrm-core/';
if (!defined('CIVICRM_TEMPLATE_COMPILEDIR')) {
  define('CIVICRM_TEMPLATE_COMPILEDIR', '{{getv "/ds-composites/private-files"}}/civicrm/templates_c');
}

if (!defined('CIVICRM_UF_BASEURL')) {
  define('CIVICRM_UF_BASEURL', '{{getv "/ds-composites/baseurl"}}');
}

// Override the extensions directory.
$civicrm_setting['domain']['extensionsDir'] = realpath(DRUPAL_ROOT . '/sites/default/civicrm_ext/');

// Override the extensions resource URL
$civicrm_setting['domain']['extensionsURL'] = CIVICRM_UF_BASEURL.'/sites/default/civicrm_ext/';
